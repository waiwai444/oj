Backtracking is enough for this problem.
All sequences in this problem are of sizes not more than 80.

A WA in uva due to presentation error.

0.025s in uva
